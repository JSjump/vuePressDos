# 安全规约
---

> 红色 <font color=#FF0000 >*</font> 代表强制，必须遵循！

### SecurityProtocol

* <font color=#FF0000 >*</font> 隶属于用户个人的页面或者功能必须进行权限控制校验
> <font color=#977D06 >说明：</font> 防止没有做水平权限校验就可随意访问、修改、删除别人的数据，比如查看他人的私信内容。

* <font color=#FF0000 >*</font> 用户敏感数据禁止直接展示，必须对展示数据进行脱敏
> <font color=#977D06 >说明：</font> 中国大陆个人手机号码显示：139****1219，隐藏中间 4 位，防止隐私泄露

* <font color=#FF0000 >*</font> 用户输入的 SQL 参数严格使用参数绑定或者 METADATA 字段值限定，防止 SQL 注入，禁止字符串拼接 SQL 访问数据库
```java
* 反例： 某系统签名大量被恶意修改，即是因为对于危险字符 # --没有进行转义，导致数据库更新时，where
后边的信息被注释掉，对全库进行更新
```

* <font color=#FF0000 >*</font> 用户请求传入的任何参数必须做有效性验证。
> <font color=#977D06 >说明：</font> 忽略参数校验可能导致：
> * page size 过大导致内存溢出
> * 恶意 order by 导致数据库慢查询
> * 缓存击穿
> * SSRF
> * 任意重定向
> * SQL 注入，Shell 注入，反序列化注入
> * 正则输入源串拒绝服务 ReDoS

Java 代码用正则来验证客户端的输入，有些正则写法验证普通用户输入没有问题，但是如果攻击人员使用
的是特殊构造的字符串来验证，有可能导致死循环的结果

* <font color=#FF0000 >*</font> 表单、AJAX 提交必须执行 CSRF 安全验证。
> <font color=#977D06 >说明：</font> CSRF(Cross-site request forgery)跨站请求伪造是一类常见编程漏洞。对于存在 CSRF 漏洞的应用/网站，攻击者可以事先构造好 URL，只要受害者用户一访问，后台便在用户不知情的情况下对数据库中用户参数进行相应修改。

* <font color=#FF0000 >*</font> URL 外部重定向传入的目标地址必须执行白名单过滤。

* 发贴、评论、发送即时消息等用户生成内容的场景必须实现防刷、文本内容违禁词过
滤等风控策略。

